<!-- Formulario -->
<div class="col-12 col-lg-7">
  <div class="surface p-4">
    <h5 class="mb-3">Pago con tarjeta</h5>

    <form (ngSubmit)="submit(f)" #f="ngForm" autocomplete="off" novalidate>
      <!-- Nombre -->
      <div class="mb-3">
        <label for="cc-name" class="form-label">Nombre en la tarjeta</label>
        <input
          id="cc-name"
          name="name"
          class="form-control"
          [(ngModel)]="name"
          required
          placeholder="Como aparece en la tarjeta"
        />
        <div *ngIf="f.submitted && !name" class="invalid-feedback d-block">
          ⚠️ Ingresa el nombre que aparece en la tarjeta.
        </div>
      </div>

      <!-- Número -->
      <div class="mb-3">
        <label for="cc-number" class="form-label">Número de tarjeta</label>
        <div class="input-group">
          <span class="input-group-text bg-transparent border-end-0">
            <i class="bi bi-credit-card-2-front"></i>
          </span>
          <input
            id="cc-number"
            name="card"
            class="form-control border-start-0"
            [(ngModel)]="card"
            required
            pattern="[0-9]{13,19}"
            inputmode="numeric"
            placeholder="4111111111111111"
          />
        </div>
        <div *ngIf="f.submitted && !cardValid()" class="invalid-feedback d-block">
          ⚠️ El número debe tener entre 13 y 19 dígitos.
        </div>
      </div>

      <!-- Exp / CVV -->
      <div class="row g-3">
        <div class="col-6">
          <label for="cc-exp" class="form-label">Expiración (MM/YY)</label>
          <input
            id="cc-exp"
            name="exp"
            class="form-control"
            [(ngModel)]="exp"
            required
            pattern="(0[1-9]|1[0-2])/[0-9]{2}"
            placeholder="12/28"
            inputmode="numeric"
          />
          <div *ngIf="f.submitted && !expValid()" class="invalid-feedback d-block">
            ⚠️ Usa el formato correcto: MM/YY (ejemplo 08/27).
          </div>
        </div>

        <div class="col-6">
          <label for="cc-cvv" class="form-label">CVV</label>
          <input
            id="cc-cvv"
            name="cvv"
            class="form-control"
            [(ngModel)]="cvv"
            required
            pattern="[0-9]{3,4}"
            placeholder="123"
            inputmode="numeric"
          />
          <div *ngIf="f.submitted && !cvvValid()" class="invalid-feedback d-block">
            ⚠️ El CVV debe tener 3 o 4 dígitos.
          </div>
        </div>
      </div>

      <!-- Botón pagar -->
      <button
        class="btn btn-primary btn-lg w-100 mt-4"
        [disabled]="!formValid()"
        type="submit"
      >
        <i class="bi bi-shield-lock me-2"></i>
        Pagar {{ total() | currency:'GTQ':'symbol-narrow':'1.2-2' }}
      </button>

      <!-- Nota -->
      <div class="d-flex align-items-center gap-2 mt-3 text-muted small">
        <i class="bi bi-lock"></i><span>Demo: no se procesa ningún pago real.</span>
      </div>
    </form>
  </div>
</div>
